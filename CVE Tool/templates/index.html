<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <title>CVE Search</title>
</head>
<body>
    <h1>Search for CVE Details</h1>
    <form method="post" action="/">
        <label for="cve_id">Enter CVE ID:(Play game with â†‘ )</label>
        <input type="text" id="cve_id" name="cve_id" required>
        <button type="submit">Search</button>
        <div id="loading-dino-game" style="display:none;"></div>
        {% include 'dino_game.html' %}
        </div>
    </form>
    {% if error_message %}
    <p class="error-message">{{ error_message }}</p>
    {% endif %}
    
    {% if cve_data_nvd %}
    <div class="results">
        <div class="result-section">
            <h2>Results for {{ cve_id }}</h2>
            <div class="cvss-severity-box">
                <p>{{ cve_data_nvd.cvss }} {{ cve_data_nvd.severity }}</p>
            </div>
            <p><strong>Description (NVD):</strong> {{ cve_data_nvd.description }}</p>

            <!-- Conditionally Display CVSS v3.1 Data -->
            {% if cve_data_nvd.severity_v31 %}
            <div class="cvss-version-section">
                <h3>CVSS v3.1</h3>
                <p><strong>Severity:</strong> {{ cve_data_nvd.severity_v31 }}</p>
                <p><strong>Exploitability Score:</strong> {{ cve_data_nvd.exploitability_score_v31 }}</p>
            </div>
            {% endif %}
            

            <!-- Conditionally Display CVSS v3.0 Data -->
            {% if cve_data_nvd.severity_v30 %}
            <div class="cvss-version-section">
                <h3>CVSS v3.0</h3>
                <p><strong>Severity:</strong> {{ cve_data_nvd.severity_v30 }}</p>
                <p><strong>Exploitability Score:</strong> {{ cve_data_nvd.exploitability_score_v30 }}</p>
            </div>
            {% endif %}
            

            <!-- Always Display CVSS v2.0 Data -->
            <div class="cvss-version-section">
                <h3>CVSS v2.0</h3>
                <p><strong>Severity:</strong> {{ cve_data_nvd.severity_v2 }}</p>
                <p><strong>Exploitability Score:</strong> {{ cve_data_nvd.exploitability_score_v2 }}</p>
            </div>

            <p><strong>Vector String:</strong> {{ cve_data_nvd.vector_string }}</p>
            <p><strong>Status:</strong> {{ cve_data_nvd.status }}</p>
        </div>

        <!-- MITRE Details -->
        <div class="result-section">
            <h2>MITRE Details</h2>
            <p><strong>State:</strong> {{ cve_data_mitre.state }}</p>
            <p><strong>Vendor:</strong> {{ cve_data_mitre.vendor }}</p>
            <p><strong>Product:</strong> {{ cve_data_mitre.product }}</p>
        </div>

        <div class="AI">
            <h2>AI</h2>
            <p><strong>AI:</strong> {{ ai_output }}</p>
        </div>

        <!-- Possible Exploit-DB Links from NVD -->
        <div class="result-section exploit-db-links">
            <h2>Possible {{cve_id}} Links from NVD</h2>
            {% for link in exploit_db_links %}
                <p>{{ link }}</p>
            {% endfor %}
        </div>

        <!-- Verified Exploits -->
        <div class="result-section verified-exploits">
            <h2>Verified Exploits</h2>
            {% if verified_exploits %}
                {% for exploit in verified_exploits %}
                    <p>{{ exploit[0] }}<br>
                    Download Link: <a href="{{ exploit[2] }}" target="_blank">{{ exploit[2] }}</a></p>
                {% endfor %}
            {% else %}
                <p>No verified exploits found.</p>
            {% endif %}
        </div>

        <!-- Download Section -->
        <div class="download-section">
            <form method="post" action="/add" novalidate>
                <label for="save_format">Save as:</label>
                <select id="save_format" name="save_format">
                    <option value="docx">DOCX</option>
                    <option value="md">Markdown</option>
                    <option value="pdf">PDF</option>
                </select>
                <!-- <input type="submit" value="Generate Report"> -->
                <button type="submit">Download</button>
                <input type="hidden" name="cve_id" value="{{ cve_id }}">
            </form>
            <form method="post" action="/message_email">
                <label for="email">Recipient Email:</label>
                <input type="email" id="email" name="email" required>
                <button type="submit">SEND EMAIL</button>
            </form>
        </div>
    </div>
    {% endif %}
    <script src="{{ url_for('static', filename='js/cve_colors.js') }}"></script>
</body>
</html>



